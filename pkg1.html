<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>XYZ ↔ Lab ↔ HLS (sRGB/D65) — интерактивный конвертер</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="wrap">
    <div class="title-box">Конвертер цветов</div>

    <h1>XYZ ↔ Lab ↔ HLS</h1>
    <div class="sub">Конвертер цветов на базе <span class="pill">sRGB / D65</span>. Изменяйте любой параметр — другие модели пересчитаются автоматически. Предупреждаем, когда для показа на экране приходится <em>обрезать</em> значения (вне гаммы sRGB).</div>

    <div class="grid">
      <div class="card">
        <div class="panel-title">Превью и быстрый выбор</div>
        <div class="picker">
          <input id="colorHex" type="color" value="#4ea6ff" aria-label="HEX color picker" />
          <div>
            <div class="row" style="gap:8px">
              <span class="muted">HEX</span>
              <input id="hexInput" class="editable-input" value="#4EA6FF" />
              <button id="copyHex">Скопировать</button>
            </div>
            <div class="row mini muted">RGB: 
              <input id="rgbInput" class="editable-input" value="78, 166, 255" />
            </div>
          </div>
        </div>
        <div id="preview" class="big-preview" style="margin-top:12px;background:#4ea6ff"></div>
        <div id="gamutWarn" class="warn" style="display:none;margin-top:12px">Некоторые компоненты <span class="kbd">RGB</span> оказались вне диапазона 0–255 при пересчёте из другой модели. Для отображения на экране они <strong>обрезаны</strong>. Это обычная ситуация при переходе из <span class="kbd">XYZ/Lab</span> к sRGB.</div>
      </div>

      <div class="card">
        <div class="panel-title">Управление</div>
        <div class="toolbar">
          <span class="muted">Режим ввода:</span>
          <button data-mode="sliders" class="modeBtn">Ползунки</button>
          <button data-mode="numbers" class="modeBtn">Точные значения</button>
          <button id="resetBtn">Сбросить</button>
        </div>
        <div class="foot mini">Диапазоны: XYZ (0–100 для X,Y,Z), Lab (L: 0–100, a: −128..127, b: −128..127), HLS (H: 0–360°, L,S: 0–100%).</div>
      </div>
    </div>

    <div class="grid" style="margin-top:16px">
      <div class="card">
        <div class="panel-title">XYZ (D65)</div>
        <div class="fields" id="xyzFields"></div>
      </div>

      <div class="card">
        <div class="panel-title">CIELab (D65)</div>
        <div class="fields" id="labFields"></div>
      </div>

      <div class="card">
        <div class="panel-title">HLS (от sRGB)</div>
        <div class="fields" id="hlsFields"></div>
      </div>

      <div class="card">
        <div class="panel-title">Справка (формулы)</div>
        <div class="mini muted">
          <p>Используются стандартные формулы преобразований:</p>
          <ul>
            <li>sRGB ⇄ XYZ (D65): гамма 2.4: <code>lin = (v≤0.04045) ? v/12.92 : ((v+0.055)/1.055)^2.4</code>, матрицы 3×3 из стандарта IEC 61966-2-1.</li>
            <li>XYZ ⇄ Lab (D65): <code>f(t)=t^{1/3}</code> при <code>t>0.008856</code>, иначе <code>7.787·t + 16/116</code>. Белая точка: X<sub>n</sub>=95.047, Y<sub>n</sub>=100, Z<sub>n</sub>=108.883.</li>
            <li>RGB ⇄ HLS: классические формулы из Foley/van Dam и CSS Color Level 4.</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="palette" id="colorPalette"></div>
  </div>

  <script src="script.js"></script>
</body>
</html>
